# ============================================
# SECURITY CONFIGURATION
# ============================================
# Copy this file to .env and fill in the values
# NEVER commit .env to version control

# ============================================
# NODE ENVIRONMENT
# ============================================
NODE_ENV=production

# ============================================
# JWT CONFIGURATION
# ============================================
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=change-this-to-a-strong-random-secret-at-least-32-characters-long
JWT_ALGORITHM=RS256
JWT_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d

# For RS256 (recommended for production)
JWT_PRIVATE_KEY_PATH=./keys/jwt-private.key
JWT_PUBLIC_KEY_PATH=./keys/jwt-public.key

# ============================================
# SESSION CONFIGURATION
# ============================================
SESSION_SECRET=change-this-to-another-strong-random-secret-at-least-32-characters-long
SESSION_NAME=ait.sid
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict
SESSION_MAX_AGE=1800000

# ============================================
# ENCRYPTION
# ============================================
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
ENCRYPTION_ALGORITHM=aes-256-gcm

# ============================================
# BCRYPT CONFIGURATION
# ============================================
BCRYPT_ROUNDS=12

# ============================================
# CORS CONFIGURATION
# ============================================
CORS_ORIGIN=https://sorianomediadore.com,https://www.sorianomediadore.com,https://app.sorianomediadore.com,https://admin.sorianomediadore.com
CORS_CREDENTIALS=true

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_GLOBAL_TTL=60000
RATE_LIMIT_GLOBAL_LIMIT=100
RATE_LIMIT_LOGIN_TTL=900000
RATE_LIMIT_LOGIN_LIMIT=5

# ============================================
# IP FILTERING
# ============================================
IP_WHITELIST=
IP_BLACKLIST=

# ============================================
# API KEYS
# ============================================
# Comma-separated list of valid API keys
VALID_API_KEYS=

# ============================================
# HELMET CONFIGURATION
# ============================================
HELMET_ENABLED=true
HELMET_CONTENT_SECURITY_POLICY=true
HELMET_HSTS_ENABLED=true
HELMET_HSTS_MAX_AGE=31536000
HELMET_HSTS_INCLUDE_SUBDOMAINS=true
HELMET_HSTS_PRELOAD=true

# ============================================
# CSP CONFIGURATION
# ============================================
CSP_REPORT_URI=/api/csp-report
CSP_REPORT_ONLY=false

# ============================================
# REDIS CONFIGURATION
# ============================================
# For session storage and rate limiting
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_TLS=true

# ============================================
# DATABASE CONFIGURATION
# ============================================
DATABASE_URL=postgresql://user:password@localhost:5432/aitcore?ssl=true
DATABASE_SSL=true
DATABASE_SSL_REJECT_UNAUTHORIZED=true
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# ============================================
# MFA CONFIGURATION
# ============================================
MFA_ENABLED=true
MFA_ISSUER=AIT-CORE
MFA_ALGORITHM=SHA256
MFA_DIGITS=6
MFA_PERIOD=30

# ============================================
# EMAIL CONFIGURATION
# ============================================
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=noreply@sorianomediadore.com
SMTP_PASS=
SMTP_FROM=AIT-CORE <noreply@sorianomediadore.com>

# ============================================
# SSL/TLS CONFIGURATION
# ============================================
SSL_CERT_PATH=./ssl/cert.pem
SSL_KEY_PATH=./ssl/key.pem
SSL_CA_PATH=./ssl/ca.pem
TLS_VERSION=TLSv1.3

# ============================================
# MONITORING & LOGGING
# ============================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_SECURITY_EVENTS=true
LOG_FAILED_LOGINS=true
LOG_API_CALLS=true
LOG_RETENTION_DAYS=90

# Sentry
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================
# SECURITY HEADERS
# ============================================
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
X_XSS_PROTECTION=1; mode=block
REFERRER_POLICY=strict-origin-when-cross-origin
PERMISSIONS_POLICY=geolocation=(), microphone=(), camera=()

# ============================================
# FILE UPLOAD
# ============================================
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf
UPLOAD_DESTINATION=./uploads
SCAN_UPLOADS_FOR_VIRUSES=true

# ============================================
# AUTHENTICATION
# ============================================
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=900000
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_EXPIRATION_DAYS=90
SESSION_TIMEOUT=1800000
ALLOW_CONCURRENT_SESSIONS=false
MAX_CONCURRENT_SESSIONS=1

# ============================================
# VULNERABILITY SCANNING
# ============================================
SNYK_TOKEN=
SONARQUBE_URL=
SONARQUBE_TOKEN=

# ============================================
# SECURITY NOTIFICATIONS
# ============================================
SECURITY_ALERT_EMAIL=security@sorianomediadore.com
SLACK_WEBHOOK_URL=
ALERT_ON_SUSPICIOUS_ACTIVITY=true
ALERT_THRESHOLD=10

# ============================================
# COMPLIANCE
# ============================================
GDPR_ENABLED=true
DATA_RETENTION_DAYS=365
AUDIT_LOG_RETENTION_DAYS=2555
ENABLE_RIGHT_TO_BE_FORGOTTEN=true
ENABLE_DATA_PORTABILITY=true

# ============================================
# BACKUP & RECOVERY
# ============================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION=true

# ============================================
# EXTERNAL SERVICES
# ============================================
# Third-party service API keys (if needed)
GOOGLE_ANALYTICS_ID=
STRIPE_SECRET_KEY=
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=eu-west-1

# ============================================
# DEVELOPMENT ONLY (Remove in production)
# ============================================
# ENABLE_SWAGGER=false
# DEBUG_MODE=false
# VERBOSE_ERRORS=false
